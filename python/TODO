- refactor extractor common code into a shared file
